<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ê°„ë‹¨ ë£°ë ›</title>
  <style>
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      display:flex; flex-direction:column; align-items:center; gap:14px;
      padding:24px; background:#0f172a; color:#e2e8f0;
    }
    .wrap{
      position:relative; width:320px; height:320px;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.35));
    }
    canvas{
      width:100%; height:100%;
      background:#0b1020; border-radius:50%;
    }
    .pin{
      position:absolute; top:-6px; left:50%; transform:translateX(-50%);
      width:0; height:0;
      border-left:12px solid transparent;
      border-right:12px solid transparent;
      border-bottom:24px solid #fbbf24;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,.4));
    }
    button{
      background:#22c55e; color:#052e16; border:none; cursor:pointer;
      padding:10px 16px; border-radius:12px; font-weight:700; font-size:16px;
      transition:.15s transform, .15s opacity;
    }
    button:active{ transform:translateY(1px) scale(.98); }
    button:disabled{ opacity:.5; cursor:not-allowed; }
    .result{
      min-height:28px; font-size:18px; font-weight:700; color:#a7f3d0;
    }
    .hint{ font-size:12px; opacity:.7; }
  </style>
</head>
<body>
  <h2>ğŸ¡ ê°„ë‹¨ ë£°ë ›</h2>

  <div class="wrap">
    <div class="pin"></div>
    <canvas id="wheel" width="600" height="600"></canvas>
  </div>

  <button id="spinBtn">ëŒë¦¬ê¸°</button>
  <div class="result" id="result"></div>


<script>
(() => {
  const items = ["ì¹˜í‚¨", "í”¼ì", "ì´ˆë°¥", "í–„ë²„ê±°", "ìƒëŸ¬ë“œ", "ë¼ë©´"]; // âœ… ì—¬ê¸° ìˆ˜ì •

  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");
  const spinBtn = document.getElementById("spinBtn");
  const resultEl = document.getElementById("result");

  const W = canvas.width, H = canvas.height;
  const cx = W/2, cy = H/2;
  const radius = Math.min(W,H)/2 - 8;

  const colors = [
    "#60a5fa","#34d399","#fbbf24","#f87171",
    "#a78bfa","#fb7185","#2dd4bf","#c084fc"
  ];

  let angle = 0;          // í˜„ì¬ íšŒì „ ê°ë„(rad)
  let speed = 0;          // í˜„ì¬ ì†ë„(rad/frame)
  let spinning = false;   // íšŒì „ ì¤‘ ì—¬ë¶€
  let targetIndex = null; // ë©ˆì¶œ ì¸ë±ìŠ¤

  function drawWheel(){
    ctx.clearRect(0,0,W,H);

    const slice = (Math.PI*2)/items.length;

    // ë°”ê¹¥ í…Œë‘ë¦¬
    ctx.beginPath();
    ctx.arc(cx,cy,radius+4,0,Math.PI*2);
    ctx.fillStyle = "#0b1020";
    ctx.fill();

    for(let i=0;i<items.length;i++){
      const start = angle + i*slice;
      const end   = start + slice;

      // ì„¹í„°
      ctx.beginPath();
      ctx.moveTo(cx,cy);
      ctx.arc(cx,cy,radius,start,end);
      ctx.closePath();
      ctx.fillStyle = colors[i % colors.length];
      ctx.fill();

      // í…ìŠ¤íŠ¸
      ctx.save();
      ctx.translate(cx,cy);
      ctx.rotate(start + slice/2);
      ctx.textAlign = "right";
      ctx.fillStyle = "#0b1020";
      ctx.font = "bold 26px system-ui";
      ctx.fillText(items[i], radius - 14, 10);
      ctx.restore();
    }

    // ê°€ìš´ë° ì›
    ctx.beginPath();
    ctx.arc(cx,cy,52,0,Math.PI*2);
    ctx.fillStyle = "#0f172a";
    ctx.fill();
    ctx.strokeStyle = "rgba(255,255,255,.25)";
    ctx.lineWidth = 4;
    ctx.stroke();

    ctx.fillStyle = "#e2e8f0";
    ctx.font = "800 20px system-ui";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText("SPIN", cx, cy);
  }

  function getCurrentIndex(){
    const slice = (Math.PI*2)/items.length;
    // í•€ì€ ìœ„ìª½( -90ë„ )ì— ìˆìœ¼ë¯€ë¡œ ê¸°ì¤€ì„ ë§ì¶¤
    const normalized = (Math.PI*2 - (angle % (Math.PI*2)) + Math.PI/2) % (Math.PI*2);
    return Math.floor(normalized / slice) % items.length;
  }

  function animate(){
    if(!spinning) return;

    angle += speed;

    // ê°ì†
    speed *= 0.985;

    // ëª©í‘œ ì¸ë±ìŠ¤ ê·¼ì²˜ì—ì„œ ë” ê°•í•˜ê²Œ ê°ì†í•´ ì •í™•íˆ ë©ˆì¶”ê¸°
    if(targetIndex !== null){
      const idx = getCurrentIndex();
      if(idx === targetIndex && speed < 0.03){
        spinning = false;
        speed = 0;
        const finalIdx = getCurrentIndex();
        resultEl.textContent = `ê²°ê³¼: ${items[finalIdx]} ğŸ‰`;
        spinBtn.disabled = false;
      }
    }

    drawWheel();
    requestAnimationFrame(animate);
  }

  spinBtn.addEventListener("click", () => {
    if(spinning) return;
    resultEl.textContent = "";
    spinBtn.disabled = true;

    // ëœë¤ ëª©í‘œ ì„ íƒ
    targetIndex = Math.floor(Math.random() * items.length);

    // ì´ˆê¸° ì†ë„(ëœë¤)
    speed = 0.35 + Math.random() * 0.25;
    spinning = true;
    animate();
  });

  drawWheel();
})();
</script>
</body>
</html>

